<!DOCTYPE html>
<html>

<head>
    <%include partials/head.html%>

    <link href='/stylesheets/fullcalendar.css' rel='stylesheet' />

    <!-- Calendar scripts -->

    <script src='/javascripts/moment.min.js'></script>
    <script src='/javascripts/fullcalendar.js'></script>
    <script src='/javascripts/fr.js'></script>

    <script>
        $(document).ready(function() {

            $('#calendar').fullCalendar({
                header: {
                    left: '',
                    center: 'title',
                    right: 'prev,next'
                },
                locale: 'fr',
                navLinks: true, // can click day/week names to navigate views
                selectable: true,
                selectHelper: true,
                select: function() {
                    $('#calendar').fullCalendar('unselect');
                },
                editable: true,
                eventLimit: true, // allow "more" link when too many events
                eventColor: '#3AB2AE',
                events: [
                    <% var keys = Object.keys(planiz.bestAvailabilities);
                    if(planiz.bestAvailabilities && keys.length > 1){
                        keys.sort();
                        var startDate = new Date(planiz.bestAvailabilities[""+keys[keys.length-1]].start + "Z");
                        var endDate = new Date(planiz.bestAvailabilities[""+keys[keys.length-1]].end + "Z");
                        endDate.setDate(endDate.getDate() + 1)%>
                        {
                            title: '',
                            start: '<%= planiz.bestAvailabilities[""+keys[keys.length-1]].start%>',
                            end: '<%= endDate.toISOString().substring(0, 10)%>'
                        }
                    <% } %>
                ]
                <% if (startDate) {%>
                    , defaultDate: '<%= startDate %>'
                <% } %>
            });

        });
    </script>

</head>

<body>

    <%include partials/share_planiz_modal.ejs%>
    <div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">

        <%include partials/header.html%>
        <%include partials/left_menu.ejs%>

        <main class="mdl-layout__content mdl-color--grey-100">

            <div class="demo-content">

                <br>

                <div class="mdl-grid">

                    <!-- Description -->
                    <div class="demo-cards mdl-cell mdl-cell--12-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing" >
                        <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop" >
                            <div class="card">
                                <div class="card-block ">
                                    <h2 class="card-title"><%= title%></h2>
                                </div>
                            </div>
                            <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                                <%= planiz.description%>
                            </div>
                            <div class="mdl-card__menu">
                                <button class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect" id="hdrbtn" data-toggle="modal" data-target="#myModal">
                                    <i class="material-icons">share</i>
                                </button>
                            </div>
                        </div>

                    </div>


                    <!-- Dates -->

                    <div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
                        <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
                            <div class="card">
                                <div class="card-block ">
                                        <h2 class="card-title"><i class="material-icons" role="presentation">date_range</i>   Dates</h2>
                                </div>
                            </div>
                            <div id='calendar' name="calendar" style="height:10%;"></div>
                        </div>
                    </div>

                    <!-- Destination -->

                    <div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
                        <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
                            <div class="card">
                                <div class="card-block ">
                                    <h2 class="card-title"><i class="material-icons" role="presentation">map</i>   Destination</h2>
                                </div>
                            </div>
                            <% if(planiz.bestDestinations && planiz.bestDestinations.length > 0){ %>
                                <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                                    <%= planiz.bestDestinations[0].no%>   <%= planiz.bestDestinations[0].name%>
                                </div>
                                <% if(planiz.bestDestinations.length > 1){ %>
                                    <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                                        <%= planiz.bestDestinations[1].no%>   <%= planiz.bestDestinations[1].name%>
                                    </div>
                            <%} } else { %>
                                <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                                    Nobody has voted any destination yet.
                                </div>
                            <%}%>
                        </div>
                    </div>

                    <!-- Budget -->

                   <div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
                        <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
                            <div class="card">
                                <div class="card-block ">
                                    <h2 class="card-title"><i class="material-icons" role="presentation">deuro_symbol</i>   Budget</h2>
                                </div>
                            </div>
                            <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                                <% if(planiz.budgetMin) { %>
                                    Budget du groupe : <%= planiz.budgetMin%> â‚¬
                                <% } else {%>
                                    No budget entered yet.
                                <% } %>
                            </div>
                        </div>
                    </div>

                    <!-- Tableau de bord -->

                    <div class="demo-cards mdl-cell mdl-cell--12-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
                        <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
                            <div class="card">
                                <div class="card-block ">
                                    <h2 class="card-title">  Tableau de bord</h2>
                                </div>
                            </div>
                            <svg fill="#3AB2AE" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop">
                                <use xlink:href="#piechart" mask="url(#piemask)" />
                                <text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan font-size="0.2" dy="-0.07">%</tspan></text>
                            </svg>
                        </div>
                    </div>


                </div>
            </div>
        </main>
    </div>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" style="position: fixed; left: -1000px; height: -1000px;">
        <defs>
            <mask id="piemask" maskContentUnits="objectBoundingBox">
                <circle cx=0.5 cy=0.5 r=0.49 fill="white" />
                <circle cx=0.5 cy=0.5 r=0.40 fill="black" />
            </mask>
            <g id="piechart">
                <circle cx=0.5 cy=0.5 r=0.5 />
                <path d="M 0.5 0.5 0.5 0 A 0.5 0.5 0 0 1 0.95 0.28 z" stroke="none" fill="rgba(255, 255, 255, 0.75)" />
            </g>
        </defs>
    </svg>
</body>
</html>
